(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{205:function(t,e,r){"use strict";(function(t){var n=r(2),o=r.n(n),d=r(215);e.a={middleware:"Auth",meta:{requiresAuth:!0},layout:"admin",components:{Pagination:d.a},data:function(){return{orders:[],tempOrder:{create_at:"",id:"",is_paid:"",message:"",paid_date:"",payment_method:"",products:{},total:"",user:{address:"",email:"",name:"",tel:""},num:""},pagination:{}}},computed:{isLoading:function(){return this.$store.state.isLoading}},created:function(){this.getOrdersData()},methods:{del:function(t){delete this.test[t],console.log(this.test)},getOrdersData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this;e.$store.dispatch("updateLoading",!0);var r="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/orders?page=").concat(t);o.a.get(r).then((function(t){console.log("後台取得訂單資料：",t),e.orders=t.data.orders,e.pagination=t.data.pagination,e.$store.dispatch("updateLoading",!1)}))},updateOrder:function(){var e=this;e.$store.dispatch("updateLoading",!0);var r="".concat("https://vue-course-api.hexschool.io","/api/").concat("komu","/admin/order/").concat(e.tempOrder.id);o.a.put(r,{data:e.tempOrder}).then((function(r){console.log("更新訂單資料：",r),e.getOrdersData(),t("#OrderModal").modal("hide")}))},openModal:function(e){this.tempOrder=Object.assign({},e),t("#OrderModal").modal("show")}}}}).call(this,r(42))},215:function(t,e,r){"use strict";var n={props:["pagination"],methods:{goPage:function(t){this.$emit("gopage",t)}}},o=r(3),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{attrs:{"aria-label":"Page navigation example"}},[r("ul",{staticClass:"pagination"},[r("li",{staticClass:"page-item",class:{disabled:!t.pagination.has_pre}},[r("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(e){return e.preventDefault(),t.goPage(t.pagination.current_page-1)}}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]),t._v(" "),t._l(t.pagination.total_pages,(function(e){return r("li",{key:e,staticClass:"page-item",class:{active:t.pagination.current_page===e}},[r("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),t.goPage(e)}}},[t._v(t._s(e))])])})),t._v(" "),r("li",{staticClass:"page-item",class:{disabled:!t.pagination.has_next}},[r("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(e){return e.preventDefault(),t.goPage(t.pagination.current_page+1)}}},[r("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])])],2)])}),[],!1,null,null,null);e.a=component.exports},247:function(t,e,r){"use strict";r.r(e);var n=r(205).a,o=r(3),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),r("table",{staticClass:"table mt-3"},[t._m(0),t._v(" "),r("tbody",t._l(t.orders,(function(e){return r("tr",{key:e.id},[r("td",[e.is_paid?r("div",{staticClass:"text-success text-center"},[t._v("\n            已付款\n          ")]):t._e(),t._v(" "),e.is_paid?t._e():r("div",{staticClass:"text-danger text-center"},[t._v("\n            未付款\n          ")])]),t._v(" "),r("td",[t._v(t._s(e.id))]),t._v(" "),r("td",[t._v(t._s(t._f("formatTime")(e.create_at)))]),t._v(" "),r("td",[t._v(t._s(e.message))]),t._v(" "),r("td",{staticClass:"text-right"},[t._v("\n          "+t._s(t._f("currency")(e.total))+"\n        ")]),t._v(" "),r("td",[r("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(r){return r.preventDefault(),t.openModal(e)}}},[t._v("\n            編輯\n          ")])])])})),0)]),t._v(" "),r("pagination",{attrs:{pagination:t.pagination},on:{gopage:t.getOrdersData}}),t._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"OrderModal",tabindex:"-1",role:"dialog"}},[r("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[t._m(1),t._v(" "),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"form-row"},[r("div",{staticClass:"col-md-3"},[r("div",{},[t._v("\n                  下單日期："+t._s(t._f("formatTime")(t.tempOrder.create_at))+"\n                ")])]),t._v(" "),r("div",{staticClass:"col-md-5"},[r("div",{},[t._v("訂單編號："+t._s(t.tempOrder.id))])]),t._v(" "),r("div",{staticClass:"col-md-4"},[r("label",{attrs:{for:"payment_methods"}},[t._v("付款方式：")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.user.payment_method,expression:"tempOrder.user.payment_method"}],attrs:{id:"payment_methods",name:"payment_methods"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.tempOrder.user,"payment_method",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:"credit_card"}},[t._v("\n                    信用卡\n                  ")]),t._v(" "),r("option",{attrs:{value:"CVS_COD"}},[t._v("\n                    超商取貨付款\n                  ")])])]),t._v(" "),r("div",{staticClass:"col-md-3"},[r("div",{},[t._v("\n                  付款狀態：\n                  "),t.tempOrder.is_paid?r("span",{staticClass:"text-success text-center"},[t._v("已付款")]):t._e(),t._v(" "),t.tempOrder.is_paid?t._e():r("span",{staticClass:"text-danger text-center"},[t._v("未付款")])])]),t._v(" "),r("div",{staticClass:"col-md-5"},[r("div",{},[t._v("\n                  付款日期：\n                  "),t.tempOrder.is_paid?r("span",[t._v(t._s(t._f("formatTime")(t.tempOrder.paid_date)))]):t._e()])]),t._v(" "),r("div",{staticClass:"col-md-4"},[r("div",{},[t._v("訂單總額："+t._s(t.tempOrder.total)+" 元")])]),t._v(" "),r("form",{staticClass:"col-12 mt-md-2 border-top border-bottom"},[r("div",{staticClass:"form-row mb-3"},[r("div",{staticClass:"col-12 h6 my-2"},[t._v("\n                    收件人資料\n                  ")]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("label",{attrs:{for:"username"}},[t._v("收件人姓名")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.user.name,expression:"tempOrder.user.name"}],staticClass:"form-control form-control-sm",attrs:{id:"username",type:"text",name:"name",placeholder:"輸入姓名"},domProps:{value:t.tempOrder.user.name},on:{input:function(e){e.target.composing||t.$set(t.tempOrder.user,"name",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"col-md-6"},[r("label",{attrs:{for:"usertel"}},[t._v("收件人電話")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.user.tel,expression:"tempOrder.user.tel"}],staticClass:"form-control form-control-sm",attrs:{id:"usertel",type:"tel",name:"tel",placeholder:"請輸入電話"},domProps:{value:t.tempOrder.user.tel},on:{input:function(e){e.target.composing||t.$set(t.tempOrder.user,"tel",e.target.value)}}})])]),t._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"useremail"}},[t._v("Email")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.user.email,expression:"tempOrder.user.email"}],staticClass:"form-control form-control-sm",attrs:{id:"useremail",type:"email",name:"email",placeholder:"請輸入 Email"},domProps:{value:t.tempOrder.user.email},on:{input:function(e){e.target.composing||t.$set(t.tempOrder.user,"email",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"useraddress"}},[t._v("收件人地址")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.user.address,expression:"tempOrder.user.address"}],staticClass:"form-control form-control-sm",attrs:{id:"useraddress",type:"text",name:"address",placeholder:"請輸入地址"},domProps:{value:t.tempOrder.user.address},on:{input:function(e){e.target.composing||t.$set(t.tempOrder.user,"address",e.target.value)}}})]),t._v(" "),r("div",{staticClass:"form-group"},[t._m(2),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.tempOrder.message,expression:"tempOrder.message"}],staticClass:"form-control form-control-sm",attrs:{id:"comment",name:"",cols:"30",rows:"4"},domProps:{value:t.tempOrder.message},on:{input:function(e){e.target.composing||t.$set(t.tempOrder,"message",e.target.value)}}})])]),t._v(" "),r("table",{staticClass:"table"},[t._m(3),t._v(" "),r("tbody",t._l(t.tempOrder.products,(function(e){return r("tr",{key:e.id},[r("td",[r("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.product.imageUrl,alt:""}})]),t._v(" "),r("td",[t._v(t._s(e.product.title))]),t._v(" "),r("td",{staticClass:"text-right"},[t._v("\n                      "+t._s(t._f("currency")(e.product.price))+"\n                    ")]),t._v(" "),r("td",[t._v(t._s(e.qty)+"/"+t._s(e.product.unit))])])})),0)])])])]),t._v(" "),r("div",{staticClass:"modal-footer"},[r("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n            取消\n          ")]),t._v(" "),r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.updateOrder(e)}}},[t.isLoading?r("i",{staticClass:"fas fa-spinner fa-spin"}):t._e(),t._v("\n            儲存變更\n          ")])])])])])],1)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",{staticClass:"thead-light"},[r("tr",[r("th",{attrs:{scope:"col",width:"80"}},[t._v("\n          是否付款\n        ")]),t._v(" "),r("th",{attrs:{scope:"col",width:"200"}},[t._v("\n          訂單編號\n        ")]),t._v(" "),r("th",{attrs:{scope:"col",width:"110"}},[t._v("\n          下單日期\n        ")]),t._v(" "),r("th",{attrs:{scope:"col"}},[t._v("\n          訂單留言\n        ")]),t._v(" "),r("th",{attrs:{scope:"col",width:"100"}},[t._v("\n          訂單金額\n        ")]),t._v(" "),r("th",{attrs:{scope:"col",width:"80"}},[t._v("\n          編輯\n        ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"OrderModalLabel"}},[this._v("\n            編輯訂單\n          ")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{attrs:{for:"comment"}},[this._v("\n                    客戶留言\n                    "),e("small",{staticClass:"text-muted"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{attrs:{width:"30"}}),this._v(" "),e("th",[this._v("產品名稱")]),this._v(" "),e("th",{attrs:{width:"80"}},[this._v("\n                      售價\n                    ")]),this._v(" "),e("th",{attrs:{width:"70"}},[this._v("\n                      數量\n                    ")])])])}],!1,null,null,null);e.default=component.exports}}]);